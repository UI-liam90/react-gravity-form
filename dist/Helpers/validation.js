"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.validateField=exports.isRequired=exports.isEmail=exports.isUrl=exports.checkboxValidation=exports.selectValidation=exports.isEmpty=void 0;var _typeof2=_interopRequireDefault(require("@babel/runtime/helpers/typeof")),getMessage=function(a,b){return!!b&&(a&&"object"===(0,_typeof2["default"])(a)&&a.custom?a.custom:a&&"object"===(0,_typeof2["default"])(a)&&a[b]?a[b]:a)},isEmail=function(a,b,c){if(!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)){var d=getMessage(c,"email");return d||"Enter a valid email"}return!1};exports.isEmail=isEmail;var isUrl=function(a,b,c){if(!/^(https?:\/\/)?((([a-z\d]([a-z\d-]*[a-z\d])*)\.)+[a-z]{2,}|((\d{1,3}\.){3}\d{1,3}))(\:\d+)?(\/[-a-z\d%_.~+]*)*(\?[;&a-z\d%_.~+=-]*)?(\#[-a-z\d_]*)?$/i.test(a)){var d=getMessage(c,"url");return d||"Enter a valid url"}return!1};exports.isUrl=isUrl;var isEmpty=function(a){return!a};exports.isEmpty=isEmpty;var isRequired=function(a,b,c){if(a&&b){var d=getMessage(c,"required");return d||"This field is required"}return!1};exports.isRequired=isRequired;var selectValidation=function(a,b,c){return!(b===c&&a)};exports.selectValidation=selectValidation;var checkboxValidation=function(a,b){return!!(1>a.length)&&(b||"This field is required")};exports.checkboxValidation=checkboxValidation;var emailValidation=function(a,b){var c=b||!1,d=c.inputs,e=c.isRequired,f=c.errorMessage,g=f||!1,h=g.required,j=g.mismatch,k=a&&a.filter(function(a){return a&&""===a.val}).length;if((a&&2>a.length||0!==k)&&e)return h||"This field is required";if(a&&0<a.length)for(var l,m=0;a.length>m;m++)if(l=isEmail(a[m].val),l)return l;return!!(a&&2===a.length&&d&&2===d.length&&a[1]&&a[0]&&""!==a[1].val&&a[1].val!==a[0].val)&&(j||"Mismatch")},passwordValidation=function(a,b){var c=b||!1,d=c.inputs,e=c.isRequired,f=c.errorMessage,g=f||!1,h=g.required,i=g.mismatch,j=d.filter(function(a){return!a.isHidden}),k=a&&a.filter(function(a){return a&&""===a.val}).length;return(a&&0===a.length||k===j.length)&&e?h||"This field is required":!!(a&&2===a.length&&j&&2===j.length&&a[1]&&a[0]&&""!==a[1].val&&a[1].val!==a[0].val)&&(i||"Mismatch")},isPostcode=function(a,b,c){if(!/^[1-9][0-9]{3} ?(?!sa|sd|ss)[a-z]{2}$/i.test(a)){var d=getMessage(c,"email");return d||"Enter a valid postcode"}return!1},isDate=function(a,b){for(var c=[],d=0;d<a.length;d++)if(a[d]){var e=a[d],f=e.val,g=e.label;if(f)if("MM"===g){var h=b.errorMessage.month;(f.length>2||f<1||f>12)&&(c[d]={index:d,message:getMessage(h,"date")||"Enter a valid month"})}else if("DD"===g){var j=b.errorMessage.date;(f.length>2||f<1||f>31)&&(c[d]={index:d,message:getMessage(j,"date")||"Enter a valid date"})}else if("YYYY"===g){var k=b.errorMessage.year,l=new Date().getFullYear()+1;(f.length>4||f<1920||f>l)&&(c[d]={index:d,message:getMessage(k,"date")||"Enter a valid year"})}}return c},validateField=function(a,b){var c=b.type,d=b.isRequired;if(("checkbox"===c||"radio"===c)&&d)return checkboxValidation(a,b.errorMessage);if("password"===c)return passwordValidation(a,b);if("email"===c&&b.emailConfirmEnabled)return emailValidation(a,b);var e=isEmpty(a),f="",g=!!(b&&b.errorMessage)&&b.errorMessage;if(f=!!d&&isRequired(d,e,g),!f&&!e)if("email"===c)f=isEmail(a,b,g);else if("website"===c)f=isUrl(a,b,g);else if("date"===c){var h=!0;h=b.dateType&&"datepicker"===b.dateType?!!d&&isRequired(d,e,g):isDate(a,b),f=!!(0<h.length)&&h}else"postcode"===c&&(f=isPostcode(a,b,g));return f};exports.validateField=validateField;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9IZWxwZXJzL3ZhbGlkYXRpb24uanMiXSwibmFtZXMiOlsiZ2V0TWVzc2FnZSIsIm1lc3NhZ2UiLCJ0eXBlIiwiY3VzdG9tIiwiaXNFbWFpbCIsImVtYWlsIiwiZmllbGQiLCJ0ZXN0IiwiY3VzdG9tTWVzc2FnZSIsImlzVXJsIiwic3RyIiwiaXNFbXB0eSIsInZhbHVlIiwiaXNSZXF1aXJlZCIsInJlcXVpcmVkIiwiZW1wdHkiLCJzZWxlY3RWYWxpZGF0aW9uIiwicGxhY2Vob2xkZXIiLCJjaGVja2JveFZhbGlkYXRpb24iLCJ2YWx1ZXMiLCJsZW5ndGgiLCJlbWFpbFZhbGlkYXRpb24iLCJpbnB1dHMiLCJlcnJvck1lc3NhZ2UiLCJyZXF1aXJlZE1zZyIsIm1pc21hdGNoIiwiaXNJbnB1dHNFbXB0eSIsImZpbHRlciIsIml0ZW0iLCJ2YWwiLCJpc0luVmFsaWRNYWlsIiwiaSIsInBhc3N3b3JkVmFsaWRhdGlvbiIsImZpbHRlcmVkSW5wdXRzIiwiaXNIaWRkZW4iLCJpc1Bvc3Rjb2RlIiwicG9zdGNvZGUiLCJpc0RhdGUiLCJ2YWxpZGF0aW9uIiwibGFiZWwiLCJpbmRleCIsIm1heCIsIkRhdGUiLCJnZXRGdWxsWWVhciIsInZhbGlkYXRlRmllbGQiLCJlbWFpbENvbmZpcm1FbmFibGVkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJpc1ZhbGlkIiwiZGF0ZVR5cGUiXSwibWFwcGluZ3MiOiJ1WEFBTUEsVUFBVSxDQUFHLFNBQUNDLENBQUQsQ0FBVUMsQ0FBVixDQUFtQixTQUMvQkEsQ0FEK0IsR0FJaENELENBQU8sRUFBdUIsUUFBbkIsMkJBQU9BLENBQVAsQ0FBWCxFQUEwQ0EsQ0FBTyxDQUFDRSxNQUpsQixDQUszQkYsQ0FBTyxDQUFDRSxNQUxtQixDQVFoQ0YsQ0FBTyxFQUF1QixRQUFuQiwyQkFBT0EsQ0FBUCxDQUFYLEVBQTBDQSxDQUFPLENBQUNDLENBQUQsQ0FSakIsQ0FTM0JELENBQU8sQ0FBQ0MsQ0FBRCxDQVRvQixDQVk3QkQs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Q0FBRCxDQUFXQyxDQUFYLENBQWtCZCxDQUFsQixDQUhQLENBS2RvQyxNQUFNLENBQUN6QixDQUFELENBQVFOLENBQVIsQ0FMUSxDQU8xQndDLENBQWlCLElBQW9CLENBQWpCLENBQUFDLENBQU8sQ0FBQzNCLE1BQVgsR0FBd0IyQixDQUMxQyxDQVJNLElBUWEsVUFBVCxHQUFBN0MsQ0FSSixHQVNMNEMsQ0FBaUIsQ0FBR1gsVUFBVSxDQUFDdkIsQ0FBRCxDQUFRTixDQUFSLENBQWVMLENBQWYsQ0FUekIsRUFZVCxNQUFPNkMsQ0FBQUEsQ0FDUixDIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZ2V0TWVzc2FnZSA9IChtZXNzYWdlLCB0eXBlKSA9PiB7XHJcbiAgaWYgKCF0eXBlKSByZXR1cm4gZmFsc2U7XHJcblxyXG5cclxuICBpZiAobWVzc2FnZSAmJiB0eXBlb2YgbWVzc2FnZSA9PT0gJ29iamVjdCcgJiYgbWVzc2FnZS5jdXN0b20pIHtcclxuICAgIHJldHVybiBtZXNzYWdlLmN1c3RvbTtcclxuICB9XHJcblxyXG4gIGlmIChtZXNzYWdlICYmIHR5cGVvZiBtZXNzYWdlID09PSAnb2JqZWN0JyAmJiBtZXNzYWdlW3R5cGVdKSB7XHJcbiAgICByZXR1cm4gbWVzc2FnZVt0eXBlXTtcclxuICB9XHJcblxyXG4gIHJldHVybiBtZXNzYWdlO1xyXG59O1xyXG5cclxuY29uc3QgaXNFbWFpbCA9IChlbWFpbCwgZmllbGQsIG1lc3NhZ2UpID0+IHtcclxuICBjb25zdCByZSA9IC9eKChbXjw+KClcXFtcXF1cXFxcLiw7Olxcc0BcIl0rKFxcLltePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSspKil8KFwiLitcIikpQCgoXFxbWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfV0pfCgoW2EtekEtWlxcLTAtOV0rXFwuKStbYS16QS1aXXsyLH0pKSQvO1xyXG5cclxuICBpZiAoIXJlLnRlc3QoZW1haWwpKSB7XHJcbiAgICBjb25zdCBjdXN0b21NZXNzYWdlID0gZ2V0TWVzc2FnZShtZXNzYWdlLCAnZW1haWwnKTtcclxuICAgIHJldHVybiBjdXN0b21NZXNzYWdlIHx8IFwiRW50ZXIgYSB2YWxpZCBlbWFpbFwiO1xyXG4gIH1cclxuICByZXR1cm4gZmFsc2U7XHJcbn07XHJcblxyXG5jb25zdCBpc1VybCA9IChzdHIsIGZpZWxkLCBtZXNzYWdlKSA9PiB7XHJcbiAgY29uc3QgcGF0dGVybiA9IG5ldyBSZWdFeHAoXHJcbiAgICAnXihodHRwcz86XFxcXC9cXFxcLyk/JyAvLyBwcm90b2NvbFxyXG4gICAgKyAnKCgoW2EtelxcXFxkXShbYS16XFxcXGQtXSpbYS16XFxcXGRdKSopXFxcXC4pK1thLXpdezIsfXwnIC8vIGRvbWFpbiBuYW1lXHJcbiAgICArICcoKFxcXFxkezEsM31cXFxcLil7M31cXFxcZHsxLDN9KSknIC8vIE9SIGlwICh2NCkgYWRkcmVzc1xyXG4gICAgKyAnKFxcXFw6XFxcXGQrKT8oXFxcXC9bLWEtelxcXFxkJV8ufitdKikqJyAvLyBwb3J0IGFuZCBwYXRoXHJcbiAgICArICcoXFxcXD9bOyZhLXpcXFxcZCVfLn4rPS1dKik/JyAvLyBxdWVyeSBzdHJpbmdcclxuICAgICsgJyhcXFxcI1stYS16XFxcXGRfXSopPyQnLFxyXG4gICAgJ2knLFxyXG4gICk7IC8vIGZyYWdtZW50IGxvY2F0b3JcclxuICBpZiAoIXBhdHRlcm4udGVzdChzdHIpKSB7XHJcbiAgICBjb25zdCBjdXN0b21NZXNzYWdlID0gZ2V0TWVzc2FnZShtZXNzYWdlLCAndXJsJyk7XHJcbiAgICByZXR1cm4gY3VzdG9tTWVzc2FnZSB8fCBcIkVudGVyIGEgdmFsaWQgdXJsXCI7XHJcbiAgfVxyXG4gIHJldHVybiBmYWxzZTtcclxufTtcclxuXHJcbmNvbnN0IGlzRW1wdHkgPSAodmFsdWUpID0+IHtcclxuICBpZiAoIXZhbHVlKSB7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcbiAgcmV0dXJuIGZhbHNlO1xyXG59O1xyXG5cclxuY29uc3QgaXNSZXF1aXJlZCA9IChyZXF1aXJlZCwgZW1wdHksIG1lc3NhZ2UpID0+IHtcclxuICBpZiAocmVxdWlyZWQgJiYgZW1wdHkpIHtcclxuICAgIGNvbnN0IGN1c3RvbU1lc3NhZ2UgPSBnZXRNZXNzYWdlKG1lc3NhZ2UsICdyZXF1aXJlZCcpO1xyXG4gICAgcmV0dXJuIGN1c3RvbU1lc3NhZ2UgfHwgJ1RoaXMgZmllbGQgaXMgcmVxdWlyZWQnO1xyXG4gIH1cclxuICByZXR1cm4gZmFsc2U7XHJcbn07XHJcblxyXG5jb25zdCBzZWxlY3RWYWxpZGF0aW9uID0gKHJlcXVpcmVkLCB2YWx1ZSwgcGxhY2Vob2xkZXIpID0+ICEodmFsdWUgPT09IHBsYWNlaG9sZGVyICYmIHJlcXVpcmVkKTtcclxuXHJcbmNvbnN0IGNoZWNrYm94VmFsaWRhdGlvbiA9ICh2YWx1ZXMsIG1lc3NhZ2UpID0+IHtcclxuICBpZiAodmFsdWVzLmxlbmd0aCA8IDEpIHtcclxuICAgIHJldHVybiBtZXNzYWdlIHx8ICdUaGlzIGZpZWxkIGlzIHJlcXVpcmVkJztcclxuICB9XHJcbiAgcmV0dXJuIGZhbHNlO1xyXG59O1xyXG5cclxuY29uc3QgZW1haWxWYWxpZGF0aW9uID0gKHZhbHVlcywgZmllbGQpID0+IHtcclxuICBjb25zdCB7IGlucHV0cywgaXNSZXF1aXJlZDogcmVxdWlyZWQsIGVycm9yTWVzc2FnZSB9ID0gZmllbGQgfHwgZmFsc2U7XHJcbiAgY29uc3QgeyByZXF1aXJlZDogcmVxdWlyZWRNc2csIG1pc21hdGNoIH0gPSBlcnJvck1lc3NhZ2UgfHwgZmFsc2U7XHJcblxyXG4gIC8vIGNoZWNrIGlmIGZpZWxkcyBpcyByZXF1aXJlZCBhbmQgaXNuJ3QgZW1wdHlcclxuICBjb25zdCBpc0lucHV0c0VtcHR5ID0gdmFsdWVzICYmIHZhbHVlcy5maWx0ZXIoaXRlbSA9PiBpdGVtICYmIGl0ZW0udmFsID09PSAnJykubGVuZ3RoO1xyXG5cclxuICBpZiAoKCh2YWx1ZXMgJiYgdmFsdWVzLmxlbmd0aCA8IDIpIHx8IGlzSW5wdXRzRW1wdHkgIT09IDApICYmIHJlcXVpcmVkKSB7XHJcbiAgICByZXR1cm4gcmVxdWlyZWRNc2cgfHwgJ1RoaXMgZmllbGQgaXMgcmVxdWlyZWQnO1xyXG4gIH1cclxuXHJcbiAgaWYgKHZhbHVlcyAmJiB2YWx1ZXMubGVuZ3RoID4gMCkge1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IHZhbHVlcy5sZW5ndGggPiBpOyBpKyspIHtcclxuICAgICAgY29uc3QgaXNJblZhbGlkTWFpbCA9IGlzRW1haWwodmFsdWVzW2ldLnZhbCk7XHJcbiAgICAgIGlmIChpc0luVmFsaWRNYWlsKSB7XHJcbiAgICAgICAgcmV0dXJuIGlzSW5WYWxpZE1haWw7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIGlmIHRoZXJlIGlzIHJlcGVhdCBwYXNzd29yZCBmaWVsZCA9PiBjaGVjayBpZiBtYXRjaFxyXG4gIGlmICh2YWx1ZXMgJiYgdmFsdWVzLmxlbmd0aCA9PT0gMiAmJiBpbnB1dHMgJiYgaW5wdXRzLmxlbmd0aCA9PT0gMikge1xyXG4gICAgaWYgKFxyXG4gICAgICB2YWx1ZXNbMV1cclxuICAgICAgJiYgdmFsdWVzWzBdXHJcbiAgICAgICYmIHZhbHVlc1sxXS52YWwgIT09ICcnXHJcbiAgICAgICYmIHZhbHVlc1sxXS52YWwgIT09IHZhbHVlc1swXS52YWxcclxuICAgICkge1xyXG4gICAgICByZXR1cm4gbWlzbWF0Y2ggfHwgJ01pc21hdGNoJztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiBmYWxzZTtcclxufTtcclxuXHJcbmNvbnN0IHBhc3N3b3JkVmFsaWRhdGlvbiA9ICh2YWx1ZXMsIGZpZWxkKSA9PiB7XHJcbiAgY29uc3QgeyBpbnB1dHMsIGlzUmVxdWlyZWQ6IHJlcXVpcmVkLCBlcnJvck1lc3NhZ2UgfSA9IGZpZWxkIHx8IGZhbHNlO1xyXG4gIGNvbnN0IHsgcmVxdWlyZWQ6IHJlcXVpcmVkTXNnLCBtaXNtYXRjaCB9ID0gZXJyb3JNZXNzYWdlIHx8IGZhbHNlO1xyXG5cclxuICBjb25zdCBmaWx0ZXJlZElucHV0cyA9IGlucHV0cy5maWx0ZXIoaXRlbSA9PiAhaXRlbS5pc0hpZGRlbik7XHJcblxyXG4gIC8vIGNoZWNrIGlmIGZpZWxkcyBpcyByZXF1aXJlZCBhbmQgaXNuJ3QgZW1wdHlcclxuICBjb25zdCBpc0lucHV0c0VtcHR5ID0gdmFsdWVzICYmIHZhbHVlcy5maWx0ZXIoaXRlbSA9PiBpdGVtICYmIGl0ZW0udmFsID09PSAnJykubGVuZ3RoO1xyXG5cclxuICBpZiAoXHJcbiAgICAoKHZhbHVlcyAmJiB2YWx1ZXMubGVuZ3RoID09PSAwKVxyXG4gICAgICB8fCBpc0lucHV0c0VtcHR5ID09PSBmaWx0ZXJlZElucHV0cy5sZW5ndGgpXHJcbiAgICAmJiByZXF1aXJlZFxyXG4gICkge1xyXG4gICAgcmV0dXJuIHJlcXVpcmVkTXNnIHx8ICdUaGlzIGZpZWxkIGlzIHJlcXVpcmVkJztcclxuICB9XHJcblxyXG4gIC8vIGlmIHRoZXJlIGlzIHJlcGVhdCBwYXNzd29yZCBmaWVsZCA9PiBjaGVjayBpZiBtYXRjaFxyXG4gIGlmIChcclxuICAgIHZhbHVlc1xyXG4gICAgJiYgdmFsdWVzLmxlbmd0aCA9PT0gMlxyXG4gICAgJiYgZmlsdGVyZWRJbnB1dHNcclxuICAgICYmIGZpbHRlcmVkSW5wdXRzLmxlbmd0aCA9PT0gMlxyXG4gICkge1xyXG4gICAgaWYgKFxyXG4gICAgICB2YWx1ZXNbMV1cclxuICAgICAgJiYgdmFsdWVzWzBdXHJcbiAgICAgICYmIHZhbHVlc1sxXS52YWwgIT09ICcnXHJcbiAgICAgICYmIHZhbHVlc1sxXS52YWwgIT09IHZhbHVlc1swXS52YWxcclxuICAgICkge1xyXG4gICAgICByZXR1cm4gbWlzbWF0Y2ggfHwgJ01pc21hdGNoJztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiBmYWxzZTtcclxufTtcclxuXHJcbmNvbnN0IGlzUG9zdGNvZGUgPSAocG9zdGNvZGUsIGZpZWxkLCBtZXNzYWdlKSA9PiB7XHJcbiAgY29uc3QgcmUgPSAvXlsxLTldWzAtOV17M30gPyg/IXNhfHNkfHNzKVthLXpdezJ9JC9pO1xyXG5cclxuICAgIGlmICghcmUudGVzdChwb3N0Y29kZSkpIHtcclxuICAgIGNvbnN0IGN1c3RvbU1lc3NhZ2UgPSBnZXRNZXNzYWdlKG1lc3NhZ2UsICdlbWFpbCcpO1xyXG4gICAgcmV0dXJuIGN1c3RvbU1lc3NhZ2UgfHwgXCJFbnRlciBhIHZhbGlkIHBvc3Rjb2RlXCI7XHJcbiAgfVxyXG4gIHJldHVybiBmYWxzZTtcclxufTtcclxuXHJcbmNvbnN0IGlzRGF0ZSA9ICh2YWx1ZXMsIGZpZWxkKSA9PiB7XHJcbiAgY29uc3QgdmFsaWRhdGlvbiA9IFtdO1xyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsdWVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBpZiAodmFsdWVzW2ldKSB7XHJcbiAgICAgIGNvbnN0IHsgdmFsLCBsYWJlbCB9ID0gdmFsdWVzW2ldO1xyXG4gICAgICBpZiAodmFsKSB7XHJcbiAgICAgICAgaWYgKGxhYmVsID09PSAnTU0nKSB7XHJcbiAgICAgICAgICBjb25zdCBtZXNzYWdlID0gZmllbGQuZXJyb3JNZXNzYWdlWydtb250aCddO1xyXG4gICAgICAgICAgY29uc3QgbWF4ID0gMTI7XHJcbiAgICAgICAgICBjb25zdCBtaW4gPSAxO1xyXG4gICAgICAgICAgY29uc3QgbWF4TGVuZ3RoID0gMjtcclxuICAgICAgICAgIGlmICh2YWwubGVuZ3RoID4gbWF4TGVuZ3RoIHx8IHZhbCA8IG1pbiB8fCB2YWwgPiBtYXgpIHtcclxuICAgICAgICAgICAgdmFsaWRhdGlvbltpXSA9IHtcclxuICAgICAgICAgICAgICBpbmRleDogaSxcclxuICAgICAgICAgICAgICBtZXNzYWdlOiBnZXRNZXNzYWdlKG1lc3NhZ2UsICdkYXRlJykgfHwgXCJFbnRlciBhIHZhbGlkIG1vbnRoXCIsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmIChsYWJlbCA9PT0gJ0REJykge1xyXG4gICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGZpZWxkLmVycm9yTWVzc2FnZVsnZGF0ZSddO1xyXG4gICAgICAgICAgY29uc3QgbWF4ID0gMzE7XHJcbiAgICAgICAgICBjb25zdCBtaW4gPSAxO1xyXG4gICAgICAgICAgY29uc3QgbWF4TGVuZ3RoID0gMjtcclxuICAgICAgICAgIGlmICh2YWwubGVuZ3RoID4gbWF4TGVuZ3RoIHx8IHZhbCA8IG1pbiB8fCB2YWwgPiBtYXgpIHtcclxuICAgICAgICAgICAgdmFsaWRhdGlvbltpXSA9IHtcclxuICAgICAgICAgICAgICBpbmRleDogaSxcclxuICAgICAgICAgICAgICBtZXNzYWdlOiBnZXRNZXNzYWdlKG1lc3NhZ2UsICdkYXRlJykgfHwgXCJFbnRlciBhIHZhbGlkIGRhdGVcIixcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKGxhYmVsID09PSAnWVlZWScpIHtcclxuICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBmaWVsZC5lcnJvck1lc3NhZ2VbJ3llYXInXTtcclxuICAgICAgICAgIGNvbnN0IG1heCA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKSArIDE7XHJcbiAgICAgICAgICBjb25zdCBtaW4gPSAxOTIwO1xyXG4gICAgICAgICAgY29uc3QgbWF4TGVuZ3RoID0gNDtcclxuICAgICAgICAgIGlmICh2YWwubGVuZ3RoID4gbWF4TGVuZ3RoIHx8IHZhbCA8IG1pbiB8fCB2YWwgPiBtYXgpIHtcclxuICAgICAgICAgICAgdmFsaWRhdGlvbltpXSA9IHtcclxuICAgICAgICAgICAgICBpbmRleDogaSxcclxuICAgICAgICAgICAgICBtZXNzYWdlOiBnZXRNZXNzYWdlKG1lc3NhZ2UsICdkYXRlJykgfHwgXCJFbnRlciBhIHZhbGlkIHllYXJcIixcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIHZhbGlkYXRpb247XHJcbn07XHJcblxyXG5jb25zdCB2YWxpZGF0ZUZpZWxkID0gKHZhbHVlLCBmaWVsZCkgPT4ge1xyXG4gIGNvbnN0IHsgdHlwZSwgaXNSZXF1aXJlZDogcmVxdWlyZWQgfSA9IGZpZWxkO1xyXG4gIC8vIENoZWNrIGZpcnN0IGlmIHJlcXVyaWVkIGNoZWNrYm94IG9yIHJhZGlvXHJcbiAgaWYgKCh0eXBlID09PSAnY2hlY2tib3gnIHx8IHR5cGUgPT09ICdyYWRpbycpICYmIHJlcXVpcmVkKSB7XHJcbiAgICByZXR1cm4gY2hlY2tib3hWYWxpZGF0aW9uKHZhbHVlLCBmaWVsZC5lcnJvck1lc3NhZ2UpO1xyXG4gIH1cclxuXHJcbiAgaWYgKHR5cGUgPT09ICdwYXNzd29yZCcpIHtcclxuICAgIHJldHVybiBwYXNzd29yZFZhbGlkYXRpb24odmFsdWUsIGZpZWxkKTtcclxuICB9XHJcblxyXG4gIGlmICh0eXBlID09PSAnZW1haWwnICYmIGZpZWxkLmVtYWlsQ29uZmlybUVuYWJsZWQpIHtcclxuICAgIHJldHVybiBlbWFpbFZhbGlkYXRpb24odmFsdWUsIGZpZWxkKTtcclxuICB9XHJcblxyXG4gIC8vIENoZWNrIGlmIGVtcHR5XHJcbiAgY29uc3QgZW1wdHkgPSBpc0VtcHR5KHZhbHVlKTtcclxuICBsZXQgdmFsaWRhdGlvbk1lc3NhZ2UgPSAnJztcclxuICBjb25zdCBtZXNzYWdlID0gZmllbGQgJiYgZmllbGQuZXJyb3JNZXNzYWdlID8gZmllbGQuZXJyb3JNZXNzYWdlIDogZmFsc2U7XHJcbiAgLy8gU2V0IHZhbGlkYXRpb24gbWVzc2FnZSBpZiByZXF1aXJlZFxyXG4gIHZhbGlkYXRpb25NZXNzYWdlID0gcmVxdWlyZWQgPyBpc1JlcXVpcmVkKHJlcXVpcmVkLCBlbXB0eSwgbWVzc2FnZSkgOiBmYWxzZTtcclxuICAvLyBTZXQgb3RoZXIgdmFsaWRhdGlvbiBtZXNzYWdlc1xyXG4gIGlmICghdmFsaWRhdGlvbk1lc3NhZ2UgJiYgIWVtcHR5KSB7XHJcbiAgICBpZiAodHlwZSA9PT0gJ2VtYWlsJykge1xyXG4gICAgICB2YWxpZGF0aW9uTWVzc2FnZSA9IGlzRW1haWwodmFsdWUsIGZpZWxkLCBtZXNzYWdlKTtcclxuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3dlYnNpdGUnKSB7XHJcbiAgICAgIHZhbGlkYXRpb25NZXNzYWdlID0gaXNVcmwodmFsdWUsIGZpZWxkLCBtZXNzYWdlKTtcclxuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2RhdGUnKSB7XHJcbiAgICAgIGxldCBpc1ZhbGlkID0gdHJ1ZTtcclxuICAgICAgaWYgKGZpZWxkLmRhdGVUeXBlICYmIGZpZWxkLmRhdGVUeXBlID09PSAnZGF0ZXBpY2tlcicpIHtcclxuICAgICAgICBpc1ZhbGlkID0gcmVxdWlyZWQgPyBpc1JlcXVpcmVkKHJlcXVpcmVkLCBlbXB0eSwgbWVzc2FnZSkgOiBmYWxzZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpc1ZhbGlkID0gaXNEYXRlKHZhbHVlLCBmaWVsZCk7XHJcbiAgICAgIH1cclxuICAgICAgdmFsaWRhdGlvbk1lc3NhZ2UgPSBpc1ZhbGlkLmxlbmd0aCA+IDAgPyBpc1ZhbGlkIDogZmFsc2U7XHJcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdwb3N0Y29kZScpIHtcclxuICAgICAgdmFsaWRhdGlvbk1lc3NhZ2UgPSBpc1Bvc3Rjb2RlKHZhbHVlLCBmaWVsZCwgbWVzc2FnZSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiB2YWxpZGF0aW9uTWVzc2FnZTtcclxufTtcclxuXHJcbmV4cG9ydCB7XHJcbiAgaXNFbXB0eSxcclxuICBzZWxlY3RWYWxpZGF0aW9uLFxyXG4gIGNoZWNrYm94VmFsaWRhdGlvbixcclxuICBpc1VybCxcclxuICBpc0VtYWlsLFxyXG4gIGlzUmVxdWlyZWQsXHJcbiAgdmFsaWRhdGVGaWVsZCxcclxufTtcclxuIl19