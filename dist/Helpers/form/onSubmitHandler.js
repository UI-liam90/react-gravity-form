"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_isomorphicUnfetch=_interopRequireDefault(require("isomorphic-unfetch")),_index=require("./index");function onSubmit(){return _onSubmit.apply(this,arguments)}function _onSubmit(){return _onSubmit=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function a(b,c,d,e,f,g,h,i,j,k,l,m,n){var o,p,q,r,s,t,u,v,w;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(o=c.onSubmit,p=new FormData(b.target),b.preventDefault(),q=(0,_index.forceValidation)(e,d,k,l),q){a.next=6;break}return a.abrupt("return",!1);case 6:o?o(p):(g(!0),i(!1),j(!1),m(!1),n(!1),r=c.formID,s=c.backendUrl,t=c.jumpToConfirmation,u=c.onSubmitSuccess,v=c.onError,w=s.substring(0,s.indexOf("/wp-json")),(0,_isomorphicUnfetch["default"])("".concat(w,"/wp-json/gf/v2/forms/").concat(r,"/submissions"),{method:"POST",body:p}).then(function(a){return a.json()}).then(function(a){if(a&&a.is_valid){if(u){var j=u(a);if(!j)return!1}var b=a.confirmation_message,d=b||!1,e=d.type,h=d.link;if(e&&h&&"redirect"===e&&"undefined"!=typeof window)return window.location.replace(h),!1;g(!1),i(!0),m(b),t&&(0,_index.scrollToConfirmation)(c,f)}else throw{response:a}})["catch"](function(a){var b=a&&a.response&&a.response.validation_messages?a.response.validation_messages:"Something went wrong";v?(v(b),g(!1),j(!0)):(g(!1),j(!0),n(b)),t&&(0,_index.scrollToConfirmation)(c,f)}));case 7:case"end":return a.stop();}},a)})),_onSubmit.apply(this,arguments)}var _default=onSubmit;exports["default"]=_default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9IZWxwZXJzL2Zvcm0vb25TdWJtaXRIYW5kbGVyLmpzIl0sIm5hbWVzIjpbIm9uU3VibWl0IiwiZXZlbnQiLCJwcm9wcyIsImZvcm1WYWx1ZXMiLCJhY3RpdmVQYWdlIiwid3JhcHBlclJlZiIsInNldFN1Ym1pdHRpbmciLCJzdWJtaXRTdWNjZXNzIiwic2V0U3VibWl0U3VjY2VzcyIsInNldFN1Ym1pdEZhaWxlZCIsInNldFNob3dQYWdlVmFsaWRhdGlvbk1zZyIsInNldFRvdWNoZWQiLCJzZXRDb25maXJtYXRpb25NZXNzYWdlIiwic2V0RXJyb3JNZXNzYWdlcyIsImN1c3RvbU9uU3VibWl0IiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsInRhcmdldCIsInByZXZlbnREZWZhdWx0IiwiaXNQYWdlVmFsaWQiLCJmb3JtSUQiLCJiYWNrZW5kVXJsIiwianVtcFRvQ29uZmlybWF0aW9uIiwib25TdWJtaXRTdWNjZXNzIiwib25FcnJvciIsImdmU3VibWlzc2lvblVybCIsInN1YnN0cmluZyIsImluZGV4T2YiLCJtZXRob2QiLCJib2R5IiwidGhlbiIsInJlc3AiLCJqc29uIiwicmVzcG9uc2UiLCJpc192YWxpZCIsInJlcyIsImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJjb25maXJtYXRpb25fbWVzc2FnZSIsInR5cGUiLCJsaW5rIiwid2luZG93IiwibG9jYXRpb24iLCJyZXBsYWNlIiwiZXJyb3IiLCJlcnJvck1lc3NhZ2VzIiwidmFsaWRhdGlvbl9tZXNzYWdlcyJdLCJtYXBwaW5ncyI6InljQUdlQSxDQUFBQSxRLCtJQUFmLFdBQ0VDLENBREYsQ0FFRUMsQ0FGRixDQUdFQyxDQUhGLENBSUVDLENBSkYsQ0FLRUMsQ0FMRixDQU1FQyxDQU5GLENBT0VDLENBUEYsQ0FRRUMsQ0FSRixDQVNFQyxDQVRGLENBVUVDLENBVkYsQ0FXRUMsQ0FYRixDQVlFQyxDQVpGLENBYUVDLENBYkYsK0dBZW9CQyxDQWZwQixDQWV1Q1osQ0FmdkMsQ0FlVUYs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QXFHZUwsUSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmZXRjaCBmcm9tIFwiaXNvbW9ycGhpYy11bmZldGNoXCI7XHJcbmltcG9ydCB7IGZvcmNlVmFsaWRhdGlvbiwgc2Nyb2xsVG9Db25maXJtYXRpb24gfSBmcm9tIFwiLi9pbmRleFwiO1xyXG5cclxuYXN5bmMgZnVuY3Rpb24gb25TdWJtaXQoXHJcbiAgZXZlbnQsXHJcbiAgcHJvcHMsXHJcbiAgZm9ybVZhbHVlcyxcclxuICBhY3RpdmVQYWdlLFxyXG4gIHdyYXBwZXJSZWYsXHJcbiAgc2V0U3VibWl0dGluZyxcclxuICBzdWJtaXRTdWNjZXNzLFxyXG4gIHNldFN1Ym1pdFN1Y2Nlc3MsXHJcbiAgc2V0U3VibWl0RmFpbGVkLFxyXG4gIHNldFNob3dQYWdlVmFsaWRhdGlvbk1zZyxcclxuICBzZXRUb3VjaGVkLFxyXG4gIHNldENvbmZpcm1hdGlvbk1lc3NhZ2UsXHJcbiAgc2V0RXJyb3JNZXNzYWdlc1xyXG4pIHtcclxuICBjb25zdCB7IG9uU3VibWl0OiBjdXN0b21PblN1Ym1pdCB9ID0gcHJvcHM7XHJcbiAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoZXZlbnQudGFyZ2V0KTtcclxuXHJcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgY29uc3QgaXNQYWdlVmFsaWQgPSBmb3JjZVZhbGlkYXRpb24oXHJcbiAgICBhY3RpdmVQYWdlLFxyXG4gICAgZm9ybVZhbHVlcyxcclxuICAgIHNldFNob3dQYWdlVmFsaWRhdGlvbk1zZyxcclxuICAgIHNldFRvdWNoZWRcclxuICApO1xyXG4gIGlmICghaXNQYWdlVmFsaWQpIHJldHVybiBmYWxzZTtcclxuXHJcbiAgaWYgKGN1c3RvbU9uU3VibWl0KSB7XHJcbiAgICBjdXN0b21PblN1Ym1pdChmb3JtRGF0YSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHNldFN1Ym1pdHRpbmcodHJ1ZSk7XHJcbiAgICBzZXRTdWJtaXRTdWNjZXNzKGZhbHNlKTtcclxuICAgIHNldFN1Ym1pdEZhaWxlZChmYWxzZSk7XHJcbiAgICBzZXRDb25maXJtYXRpb25NZXNzYWdlKGZhbHNlKTtcclxuICAgIHNldEVycm9yTWVzc2FnZXMoZmFsc2UpO1xyXG5cclxuICAgIGNvbnN0IHsgZm9ybUlELCBiYWNrZW5kVXJsLCBqdW1wVG9Db25maXJtYXRpb24sIG9uU3VibWl0U3VjY2Vzcywgb25FcnJvciB9ID1cclxuICAgICAgcHJvcHM7XHJcbiAgICBjb25zdCBnZlN1Ym1pc3Npb25VcmwgPSBiYWNrZW5kVXJsLnN1YnN0cmluZyhcclxuICAgICAgMCxcclxuICAgICAgYmFja2VuZFVybC5pbmRleE9mKFwiL3dwLWpzb25cIilcclxuICAgICk7XHJcblxyXG4gICAgZmV0Y2goYCR7Z2ZTdWJtaXNzaW9uVXJsfS93cC1qc29uL2dmL3YyL2Zvcm1zLyR7Zm9ybUlEfS9zdWJtaXNzaW9uc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgYm9keTogZm9ybURhdGEsXHJcbiAgICB9KVxyXG4gICAgICAudGhlbihyZXNwID0+IHJlc3AuanNvbigpKVxyXG4gICAgICAudGhlbihyZXNwb25zZSA9PiB7XHJcbiAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLmlzX3ZhbGlkKSB7XHJcbiAgICAgICAgICBpZiAob25TdWJtaXRTdWNjZXNzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcyA9IG9uU3VibWl0U3VjY2VzcyhyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIGlmICghcmVzKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBjb25zdCBjb25maXJtYXRpb25NZXNzYWdlID0gcmVzcG9uc2UuY29uZmlybWF0aW9uX21lc3NhZ2U7XHJcbiAgICAgICAgICBjb25zdCB7IHR5cGUsIGxpbmsgfSA9IGNvbmZpcm1hdGlvbk1lc3NhZ2UgfHwgZmFsc2U7XHJcbiAgICAgICAgICBpZiAodHlwZSAmJiBsaW5rICYmIHR5cGUgPT09IFwicmVkaXJlY3RcIikge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKGxpbmspO1xyXG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgc2V0U3VibWl0dGluZyhmYWxzZSk7XHJcbiAgICAgICAgICBzZXRTdWJtaXRTdWNjZXNzKHRydWUpO1xyXG4gICAgICAgICAgc2V0Q29uZmlybWF0aW9uTWVzc2FnZShjb25maXJtYXRpb25NZXNzYWdlKTtcclxuXHJcbiAgICAgICAgICBpZiAoanVtcFRvQ29uZmlybWF0aW9uKSB7XHJcbiAgICAgICAgICAgIHNjcm9sbFRvQ29uZmlybWF0aW9uKHByb3BzLCB3cmFwcGVyUmVmKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICByZXNwb25zZSxcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZXMgPVxyXG4gICAgICAgICAgZXJyb3IgJiYgZXJyb3IucmVzcG9uc2UgJiYgZXJyb3IucmVzcG9uc2UudmFsaWRhdGlvbl9tZXNzYWdlc1xyXG4gICAgICAgICAgICA/IGVycm9yLnJlc3BvbnNlLnZhbGlkYXRpb25fbWVzc2FnZXNcclxuICAgICAgICAgICAgOiBcIlNvbWV0aGluZyB3ZW50IHdyb25nXCI7XHJcblxyXG4gICAgICAgIGlmIChvbkVycm9yKSB7XHJcbiAgICAgICAgICBvbkVycm9yKGVycm9yTWVzc2FnZXMpO1xyXG4gICAgICAgICAgc2V0U3VibWl0dGluZyhmYWxzZSk7XHJcbiAgICAgICAgICBzZXRTdWJtaXRGYWlsZWQodHJ1ZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHNldFN1Ym1pdHRpbmcoZmFsc2UpO1xyXG4gICAgICAgICAgc2V0U3VibWl0RmFpbGVkKHRydWUpO1xyXG4gICAgICAgICAgc2V0RXJyb3JNZXNzYWdlcyhlcnJvck1lc3NhZ2VzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChqdW1wVG9Db25maXJtYXRpb24pIHtcclxuICAgICAgICAgIHNjcm9sbFRvQ29uZmlybWF0aW9uKHByb3BzLCB3cmFwcGVyUmVmKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgb25TdWJtaXQ7XHJcbiJdfQ==