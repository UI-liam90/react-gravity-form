"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"FormConfirmation",{enumerable:!0,get:function get(){return _FormElements.FormConfirmation}}),Object.defineProperty(exports,"FormError",{enumerable:!0,get:function get(){return _FormElements.FormError}}),Object.defineProperty(exports,"RenderFields",{enumerable:!0,get:function get(){return _FormElements.RenderFields}}),Object.defineProperty(exports,"Submit",{enumerable:!0,get:function get(){return _FormElements.Submit}}),Object.defineProperty(exports,"validateField",{enumerable:!0,get:function get(){return _validation.validateField}}),exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_react=_interopRequireWildcard(require("react")),_isomorphicUnfetch=_interopRequireDefault(require("isomorphic-unfetch")),_FormElements=require("./FormElements"),_form=require("./Helpers/form"),_validation=require("./Helpers/validation");function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){(0,_defineProperty2["default"])(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}var GravityForm=function(a){var b,c=a.initialPage,d=a.populatedEntry,e=a.onChange,f=(0,_react.useState)(!1),g=(0,_slicedToArray2["default"])(f,2),h=g[0],i=g[1],j=(0,_react.useState)(!1),k=(0,_slicedToArray2["default"])(j,2),l=k[0],m=k[1],n=(0,_react.useState)({}),o=(0,_slicedToArray2["default"])(n,2),p=o[0],q=o[1],r=(0,_react.useState)(!1),s=(0,_slicedToArray2["default"])(r,2),t=s[0],u=s[1],v=(0,_react.useState)(!1),w=(0,_slicedToArray2["default"])(v,2),x=w[0],y=w[1],z=(0,_react.useState)(!1),A=(0,_slicedToArray2["default"])(z,2),B=A[0],C=A[1],D=(0,_react.useState)({}),E=(0,_slicedToArray2["default"])(D,2),F=E[0],G=E[1],H=(0,_react.useState)({}),I=(0,_slicedToArray2["default"])(H,2),J=I[0],K=I[1],L=(0,_react.useState)(c||1),M=(0,_slicedToArray2["default"])(L,2),N=M[0],O=M[1],P=(0,_react.useState)({}),Q=(0,_slicedToArray2["default"])(P,2),R=Q[0],S=Q[1],T=(0,_react.useState)({}),U=(0,_slicedToArray2["default"])(T,2),V=U[0],W=U[1],X=(0,_react.useState)(!1),Y=(0,_slicedToArray2["default"])(X,2),Z=Y[0],$=Y[1],_=(0,_react.useState)(!1),aa=(0,_slicedToArray2["default"])(_,2),ba=aa[0],ca=aa[1],da=(0,_react.useState)(!1),ea=(0,_slicedToArray2["default"])(da,2),fa=ea[0],ga=ea[1],ha=(0,_react.useState)({}),ia=(0,_slicedToArray2["default"])(ha,2),ja=ia[0],ka=ia[1],la=(0,_react.useRef)(null),ma=(0,_react.useCallback)(function(a){(0,_form.updateFieldsValuesBasedOnEntry)(a)},[]);(0,_react.useEffect)(function(){(0,_form.fetchForm)(_objectSpread({setFormData:G,setFormValues:q,setActivePage:O,setConditionFields:S,setConditionalIds:W,setPages:ka,setIsMultiPart:$},a))},[]),(0,_react.useEffect)(function(){e&&e(p)},[p]),(0,_react.useEffect)(function(){d&&ma(d)},[d]);var na=function(){if(la){var a=la.current.querySelector(".form-field.error");a&&a.scrollIntoView()}},oa=a.title,pa=a.formID,qa=a.submitIcon,ra=a.saveStateToHtmlField,sa=a.styledComponents,ta=a.customComponents,ua=a.errorMessage,va=a.dropzoneText,wa=a.loadingSpinner,xa=a.onError,ya=a.language,za=a.apiKeys,Aa=sa||!1,Ba=Aa.Button,Ca=Aa.Loading,Da=Aa.FormError,Ea=Aa.FormConfirmation,Fa=Aa.GFWrapper,Ga=void 0===Fa?"div":Fa,Ha=F||{},Ia=Ha.cssClass,Ja=Ha.button;Ja=void 0===Ja?{}:Ja;var Ka=Ja.conditionalLogic,La=Ka&&(0,_form.checkConditionalLogic)(Ka,0<Object.keys(p).length?p:F.fields),Ma=function(a){a.preventDefault(),(0,_form.prevStep)(p,ja,N,O,ca)},Na=function(){var b=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function b(c){var d,e,f,g,h,j,k,l,n,o;return _regenerator["default"].wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(d=a.onSubmit,e=a.filterFormData,f=new FormData(c.target),e&&(f=e(f,p)),c.preventDefault(),g=(0,_form.forceValidation)(N,p,ga,K),g){b.next=8;break}return na(),b.abrupt("return",!1);case 8:d?d(f):(u(!0),y(!1),i(!1),C(!1),m(!1),h=a.formID,j=a.backendUrl,k=a.jumpToConfirmation,l=a.onSubmitSuccess,n=a.onError,o=j.substring(0,j.indexOf("/wp-json")),(0,_isomorphicUnfetch["default"])("".concat(o,"/wp-json/gf/v2/forms/").concat(h,"/submissions"),{method:"POST",body:f}).then(function(a){return a.json()}).then(function(b){if(b&&b.is_valid){if(l){var g=l(b);if(!g)return!1}var c=b.confirmation_message,d=c||!1,e=d.type,f=d.link;if(e&&f&&"redirect"===e&&"undefined"!=typeof window)return window.location.replace(f),!1;u(!1),y(!0),C(c),k&&(0,_form.scrollToConfirmation)(a,la,k)}else throw{response:b}})["catch"](function(b){var c=b&&b.response&&b.response.validation_messages?b.response.validation_messages:"Something went wrong";n?(n(c),u(!1),i(!0)):(u(!1),i(!0),m(c)),k&&(0,_form.scrollToConfirmation)(a,la)}));case 9:case"end":return b.stop();}},b)}));return function onSubmit(){return b.apply(this,arguments)}}();return _react["default"].createElement(Ga,{ref:la,className:"form-wrapper",id:"gravity_form_".concat(pa)},F.title?null:Ca&&_react["default"].createElement(Ca,{isLoading:!0}),h&&!x&&!xa&&_react["default"].createElement(_FormElements.FormError,{SFormError:Da||!1,errorMessage:ua||"There was a problem with your submission"}),x&&B&&_react["default"].createElement(_FormElements.FormConfirmation,{confirmation:B,SFormConfirmation:Ea}),!x&&F.fields?_react["default"].createElement("form",{onSubmit:function onSubmit(a){return Na(a)},className:Ia,encType:Z?"multipart/form-data":void 0,noValidate:!0},(F.title||F.description)&&_react["default"].createElement("div",null,F.title&&oa?_react["default"].createElement("h3",{className:"form-title"},F.title):null,F.description?_react["default"].createElement("p",{className:"form-description"},F.description):null),_react["default"].createElement("div",{className:"form-wrapper"},(null===F||void 0===F||null===(b=F.pagination)||void 0===b?void 0:b.pages)&&_react["default"].createElement(_FormElements.ProgressBar,{pagination:F.pagination,activePage:N,firstPageCssClass:F.firstPageCssClass}),_react["default"].createElement(_FormElements.RenderFields,(0,_extends2["default"])({styledComponents:sa,customComponents:ta,fields:F.fields,formValues:p,submitFailed:h,submitSuccess:x,updateForm:function updateForm(a,b,c){return(0,_form.updateFormHandler)(b,a,c,p,q,V,R)},touched:J,setTouched:function setTouched(a){return(0,_form.setTouchedHandler)(a,J,K)},setErrorMessages:m,pagination:F.pagination,activePage:N,prevStep:function prevStep(a){return Ma(a)},nextStep:function nextStep(b){return(0,_form.nextStep)(b,a,ja,p,N,O,ca,K,ga)},checkConditionalLogic:function checkConditionalLogic(a,b){return(0,_form.checkConditionalLogic)(a,b=!1)},saveStateToHtmlField:ra,enableHoneypot:F.enableHoneypot,errors:l,unsetError:function unsetError(a){return(0,_form.unsetError)(a,l)},dropzoneText:va,pageClicked:ba,language:ya,apiKeys:za},a)),(!F.pagination||F.pagination&&F.pagination.pages.length===N)&&_react["default"].createElement(_FormElements.Submit,{Button:Ba,Loading:Ca,formData:F,submitIcon:qa,submitting:t,prevStep:function prevStep(a){return Ma(a)},loadingSpinner:wa,hideSubmitButton:La}))):"")};GravityForm.defaultProps={title:!0,submitIcon:!1,saveStateToHtmlField:!1,jumpToConfirmation:!0};var _default=GravityForm;exports["default"]=_default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJHcmF2aXR5Rm9ybSIsInByb3BzIiwiaW5pdGlhbFBhZ2UiLCJwb3B1bGF0ZWRFbnRyeSIsIm9uQ2hhbmdlIiwic3VibWl0RmFpbGVkIiwic2V0U3VibWl0RmFpbGVkIiwiZXJyb3JNZXNzYWdlcyIsInNldEVycm9yTWVzc2FnZXMiLCJmb3JtVmFsdWVzIiwic2V0Rm9ybVZhbHVlcyIsInN1Ym1pdHRpbmciLCJzZXRTdWJtaXR0aW5nIiwic3VibWl0U3VjY2VzcyIsInNldFN1Ym1pdFN1Y2Nlc3MiLCJjb25maXJtYXRpb25NZXNzYWdlIiwic2V0Q29uZmlybWF0aW9uTWVzc2FnZSIsImZvcm1EYXRhIiwic2V0Rm9ybURhdGEiLCJ0b3VjaGVkIiwic2V0VG91Y2hlZCIsImFjdGl2ZVBhZ2UiLCJzZXRBY3RpdmVQYWdlIiwiY29uZGl0aW9uRmllbGRzIiwic2V0Q29uZGl0aW9uRmllbGRzIiwiY29uZGl0aW9uYWxJZHMiLCJzZXRDb25kaXRpb25hbElkcyIsImlzTXVsdGlwYXJ0Iiwic2V0SXNNdWx0aVBhcnQiLCJwYWdlQ2xpY2tlZCIsInNldFBhZ2VDbGlja2VkIiwic2hvd1BhZ2VWYWxpZGF0aW9uTXNnIiwic2V0U2hvd1BhZ2VWYWxpZGF0aW9uTXNnIiwicGFnZXMiLCJzZXRQYWdlcyIsIndyYXBwZXJSZWYiLCJ1cGRhdGVFbnRyeUZpZWxkcyIsInNjcm9sbFRvRmlyc3RJbnZhbGlkRmllbGQiLCJmaXJzdEVyckVsIiwiY3VycmVudCIsInF1ZXJ5U2VsZWN0b3IiLCJzY3JvbGxJbnRvVmlldyIsInRpdGxlIiwiZm9ybUlEIiwic3VibWl0SWNvbiIsInNhdmVTdGF0ZVRvSHRtbEZpZWxkIiwic3R5bGVkQ29tcG9uZW50cyIsImN1c3RvbUNvbXBvbmVudHMiLCJlcnJvck1lc3NhZ2UiLCJkcm9wem9uZVRleHQiLCJsb2FkaW5nU3Bpbm5lciIsIm9uRXJyb3IiLCJsYW5ndWFnZSIsImFwaUtleXMiLCJCdXR0b24iLCJMb2FkaW5nIiwiU0Zvcm1FcnJvciIsIkZvcm1FcnJvciIsIlNGb3JtQ29uZmlybWF0aW9uIiwiRm9ybUNvbmZpcm1hdGlvbiIsIkdGV3JhcHBlciIsImNzc0NsYXNzIiwiYnV0dG9uIiwiY29uZGl0aW9uYWxMb2dpYyIsImhpZGVTdWJtaXRCdXR0b24iLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwiZmllbGRzIiwiaGFuZGxlUHJldlN0ZXAiLCJlIiwicHJldmVudERlZmF1bHQiLCJvblN1Ym1pdCIsImV2ZW50IiwiY3VzdG9tT25TdWJtaXQiLCJmaWx0ZXJGb3JtRGF0YSIsIkZvcm1EYXRhIiwidGFyZ2V0IiwiaXNGb3JtVmFsaWQiLCJiYWNrZW5kVXJsIiwianVtcFRvQ29uZmlybWF0aW9uIiwib25TdWJtaXRTdWNjZXNzIiwiZ2ZTdWJtaXNzaW9uVXJsIiwic3Vic3RyaW5nIiwiaW5kZXhPZiIsIm1ldGhvZCIsImJvZHkiLCJ0aGVuIiwicmVzcCIsImpzb24iLCJyZXNwb25zZSIsImlzX3ZhbGlkIiwicmVzIiwiY29uZmlybWF0aW9uX21lc3NhZ2UiLCJ0eXBlIiwibGluayIsIndpbmRvdyIsImxvY2F0aW9uIiwicmVwbGFjZSIsImVycm9yIiwidmFsaWRhdGlvbl9tZXNzYWdlcyIsImRlc2NyaXB0aW9uIiwicGFnaW5hdGlvbiIsImZpcnN0UGFnZUNzc0NsYXNzIiwiZmllbGQiLCJpbnB1dElEIiwiaWQiLCJjb25kaXRpb24iLCJlbmFibGVIb25leXBvdCIsImRlZmF1bHRQcm9wcyJdLCJtYXBwaW5ncyI6InVrRUFtQkEsR0FBTUEsQ0FBQUEsV0FBVyxDQUFHLFNBQUFDLENBQUssQ0FBSSxPQUNuQkMsQ0FEbUIsQ0FDdUJELENBRHZCLENBQ25CQyxXQURtQixDQUNOQyxDQURNLENBQ3VCRixDQUR2QixDQUNORSxjQURNLENBQ1VDLENBRFYsQ0FDdUJILENBRHZCLENBQ1VHLFFBRFYsR0FHYSx1QkFIYix1Q0FHcEJDLENBSG9CLE1BR05DLENBSE0sUUFJZSx1QkFKZix1Q0FJcEJDLENB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ZWFjdCwgeyB1c2VFZmZlY3QsIHVzZVN0YXRlLCB1c2VDYWxsYmFjaywgdXNlUmVmIH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgZmV0Y2ggZnJvbSAnaXNvbW9ycGhpYy11bmZldGNoJztcclxuaW1wb3J0IHsgRm9ybUNvbmZpcm1hdGlvbiwgRm9ybUVycm9yLCBSZW5kZXJGaWVsZHMsIFN1Ym1pdCwgUHJvZ3Jlc3NCYXIgfSBmcm9tICcuL0Zvcm1FbGVtZW50cyc7XHJcblxyXG5pbXBvcnQge1xyXG4gIGNoZWNrQ29uZGl0aW9uYWxMb2dpYyxcclxuICBmZXRjaEZvcm0sXHJcbiAgZm9yY2VWYWxpZGF0aW9uLFxyXG4gIG5leHRTdGVwLFxyXG4gIHByZXZTdGVwLFxyXG4gIHNjcm9sbFRvQ29uZmlybWF0aW9uLFxyXG4gIHNldFRvdWNoZWRIYW5kbGVyLFxyXG4gIHVuc2V0RXJyb3IsXHJcbiAgdXBkYXRlRmllbGRzVmFsdWVzQmFzZWRPbkVudHJ5LFxyXG4gIHVwZGF0ZUZvcm1IYW5kbGVyLFxyXG59IGZyb20gJy4vSGVscGVycy9mb3JtJztcclxuXHJcbmltcG9ydCB7IHZhbGlkYXRlRmllbGQgfSBmcm9tICcuL0hlbHBlcnMvdmFsaWRhdGlvbic7XHJcblxyXG5jb25zdCBHcmF2aXR5Rm9ybSA9IHByb3BzID0+IHtcclxuICBjb25zdCB7IGluaXRpYWxQYWdlLCBwb3B1bGF0ZWRFbnRyeSwgb25DaGFuZ2UgfSA9IHByb3BzO1xyXG5cclxuICBjb25zdCBbc3VibWl0RmFpbGVkLCBzZXRTdWJtaXRGYWlsZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIGNvbnN0IFtlcnJvck1lc3NhZ2VzLCBzZXRFcnJvck1lc3NhZ2VzXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCBbZm9ybVZhbHVlcywgc2V0Rm9ybVZhbHVlc10gPSB1c2VTdGF0ZSh7fSk7XHJcbiAgY29uc3QgW3N1Ym1pdHRpbmcsIHNldFN1Ym1pdHRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIGNvbnN0IFtzdWJtaXRTdWNjZXNzLCBzZXRTdWJtaXRTdWNjZXNzXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCBbY29uZmlybWF0aW9uTWVzc2FnZSwgc2V0Q29uZmlybWF0aW9uTWVzc2FnZV0gPSB1c2VTdGF0ZShmYWxzZSk7XHJcbiAgY29uc3QgW2Zvcm1EYXRhLCBzZXRGb3JtRGF0YV0gPSB1c2VTdGF0ZSh7fSk7XHJcbiAgY29uc3QgW3RvdWNoZWQsIHNldFRvdWNoZWRdID0gdXNlU3RhdGUoe30pO1xyXG4gIGNvbnN0IFthY3RpdmVQYWdlLCBzZXRBY3RpdmVQYWdlXSA9IHVzZVN0YXRlKGluaXRpYWxQYWdlIHx8IDEpO1xyXG4gIGNvbnN0IFtjb25kaXRpb25GaWVsZHMsIHNldENvbmRpdGlvbkZpZWxkc10gPSB1c2VTdGF0ZSh7fSk7XHJcbiAgY29uc3QgW2NvbmRpdGlvbmFsSWRzLCBzZXRDb25kaXRpb25hbElkc10gPSB1c2VTdGF0ZSh7fSk7XHJcbiAgY29uc3QgW2lzTXVsdGlwYXJ0LCBzZXRJc011bHRpUGFydF0gPSB1c2VTdGF0ZShmYWxzZSk7XHJcbiAgY29uc3QgW3BhZ2VDbGlja2VkLCBzZXRQYWdlQ2xpY2tlZF0gPSB1c2VTdGF0ZShmYWxzZSk7XHJcbiAgY29uc3QgW3Nob3dQYWdlVmFsaWRhdGlvbk1zZywgc2V0U2hvd1BhZ2VWYWxpZGF0aW9uTXNnXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCBbcGFnZXMsIHNldFBhZ2VzXSA9IHVzZVN0YXRlKHt9KTtcclxuXHJcbiAgY29uc3Qgd3JhcHBlclJlZiA9IHVzZVJlZihudWxsKTtcclxuXHJcbiAgY29uc3QgdXBkYXRlRW50cnlGaWVsZHMgPSB1c2VDYWxsYmFjayhwb3B1bGF0ZWRFbnRyeSA9PiB7XHJcbiAgICB1cGRhdGVGaWVsZHNWYWx1ZXNCYXNlZE9uRW50cnkocG9wdWxhdGVkRW50cnkpO1xyXG4gIH0sIFtdKTtcclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggZm9ybSBkYXRhXHJcbiAgICovXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGZldGNoRm9ybSh7XHJcbiAgICAgIHNldEZvcm1EYXRhLFxyXG4gICAgICBzZXRGb3JtVmFsdWVzLFxyXG4gICAgICBzZXRBY3RpdmVQYWdlLFxyXG4gICAgICBzZXRDb25kaXRpb25GaWVsZHMsXHJcbiAgICAgIHNldENvbmRpdGlvbmFsSWRzLFxyXG4gICAgICBzZXRQYWdlcyxcclxuICAgICAgc2V0SXNNdWx0aVBhcnQsXHJcbiAgICAgIC4uLnByb3BzLFxyXG4gICAgfSk7XHJcbiAgfSwgW10pO1xyXG5cclxuICAvKipcclxuICAgKiBDYWxsIGN1c3RvbSBvbkNoYW5nZSBoYW5kbGVyIHdpdGggcGFzc2VkIHZhbHVlcyBmcm9tIGZvcm1cclxuICAgKi9cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgaWYgKG9uQ2hhbmdlKSB7XHJcbiAgICAgIG9uQ2hhbmdlKGZvcm1WYWx1ZXMpO1xyXG4gICAgfVxyXG4gIH0sIFtmb3JtVmFsdWVzXSk7XHJcblxyXG4gIC8qKlxyXG4gICAqIFNldCBlbnRyeSB0byB0aGUgZm9ybVxyXG4gICAqL1xyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBpZiAocG9wdWxhdGVkRW50cnkpIHtcclxuICAgICAgdXBkYXRlRW50cnlGaWVsZHMocG9wdWxhdGVkRW50cnkpO1xyXG4gICAgfVxyXG4gIH0sIFtwb3B1bGF0ZWRFbnRyeV0pO1xyXG5cclxuICAvKipcclxuICAgKiBTY3JvbGwgcGFnZSB0byB0aGUgZmlyc3Qgbm90IHZhbGlkIGZpZWxkXHJcbiAgICovXHJcbiAgY29uc3Qgc2Nyb2xsVG9GaXJzdEludmFsaWRGaWVsZCA9ICgpID0+IHtcclxuICAgIGlmICghd3JhcHBlclJlZikgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IGZpcnN0RXJyRWwgPSB3cmFwcGVyUmVmLmN1cnJlbnQucXVlcnlTZWxlY3RvcignLmZvcm0tZmllbGQuZXJyb3InKTtcclxuICAgIGlmIChmaXJzdEVyckVsKSB7XHJcbiAgICAgIGZpcnN0RXJyRWwuc2Nyb2xsSW50b1ZpZXcoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBjb25zdCB7XHJcbiAgICB0aXRsZSxcclxuICAgIGZvcm1JRCxcclxuICAgIHN1Ym1pdEljb24sXHJcbiAgICBzYXZlU3RhdGVUb0h0bWxGaWVsZCxcclxuICAgIHN0eWxlZENvbXBvbmVudHMsXHJcbiAgICBjdXN0b21Db21wb25lbnRzLFxyXG4gICAgZXJyb3JNZXNzYWdlLFxyXG4gICAgZHJvcHpvbmVUZXh0LFxyXG4gICAgbG9hZGluZ1NwaW5uZXIsXHJcbiAgICBvbkVycm9yLFxyXG4gICAgbGFuZ3VhZ2UsXHJcbiAgICBhcGlLZXlzLFxyXG4gIH0gPSBwcm9wcztcclxuXHJcbiAgY29uc3Qge1xyXG4gICAgQnV0dG9uLFxyXG4gICAgTG9hZGluZyxcclxuICAgIEZvcm1FcnJvcjogU0Zvcm1FcnJvcixcclxuICAgIEZvcm1Db25maXJtYXRpb246IFNGb3JtQ29uZmlybWF0aW9uLFxyXG4gICAgR0ZXcmFwcGVyID0gJ2RpdicsXHJcbiAgfSA9IHN0eWxlZENvbXBvbmVudHMgfHwgZmFsc2U7XHJcblxyXG4gIGNvbnN0IHsgY3NzQ2xhc3MsIGJ1dHRvbjogeyBjb25kaXRpb25hbExvZ2ljIH0gPSB7fSB9ID0gZm9ybURhdGEgfHwge307XHJcbiAgY29uc3QgaGlkZVN1Ym1pdEJ1dHRvbiA9XHJcbiAgY29uZGl0aW9uYWxMb2dpYyAmJlxyXG4gIGNoZWNrQ29uZGl0aW9uYWxMb2dpYyhcclxuICAgIGNvbmRpdGlvbmFsTG9naWMsXHJcbiAgICBPYmplY3Qua2V5cyhmb3JtVmFsdWVzKS5sZW5ndGggPiAwID8gZm9ybVZhbHVlcyA6IGZvcm1EYXRhLmZpZWxkc1xyXG4gICk7XHJcblxyXG4gIGNvbnN0IGhhbmRsZVByZXZTdGVwID0gZSA9PiB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBwcmV2U3RlcChmb3JtVmFsdWVzLCBwYWdlcywgYWN0aXZlUGFnZSwgc2V0QWN0aXZlUGFnZSwgc2V0UGFnZUNsaWNrZWQpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IG9uU3VibWl0ID0gYXN5bmMgZXZlbnQgPT4ge1xyXG4gICAgY29uc3QgeyBvblN1Ym1pdDogY3VzdG9tT25TdWJtaXQsIGZpbHRlckZvcm1EYXRhIH0gPSBwcm9wcztcclxuICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YShldmVudC50YXJnZXQpO1xyXG5cclxuICAgIGlmIChmaWx0ZXJGb3JtRGF0YSkgZm9ybURhdGEgPSBmaWx0ZXJGb3JtRGF0YShmb3JtRGF0YSwgZm9ybVZhbHVlcyk7XHJcblxyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBjb25zdCBpc0Zvcm1WYWxpZCA9IGZvcmNlVmFsaWRhdGlvbihcclxuICAgICAgYWN0aXZlUGFnZSxcclxuICAgICAgZm9ybVZhbHVlcyxcclxuICAgICAgc2V0U2hvd1BhZ2VWYWxpZGF0aW9uTXNnLFxyXG4gICAgICBzZXRUb3VjaGVkXHJcbiAgICApO1xyXG5cclxuICAgIGlmICghaXNGb3JtVmFsaWQpIHtcclxuICAgICAgc2Nyb2xsVG9GaXJzdEludmFsaWRGaWVsZCgpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGN1c3RvbU9uU3VibWl0KSB7XHJcbiAgICAgIGN1c3RvbU9uU3VibWl0KGZvcm1EYXRhKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNldFN1Ym1pdHRpbmcodHJ1ZSk7XHJcbiAgICAgIHNldFN1Ym1pdFN1Y2Nlc3MoZmFsc2UpO1xyXG4gICAgICBzZXRTdWJtaXRGYWlsZWQoZmFsc2UpO1xyXG4gICAgICBzZXRDb25maXJtYXRpb25NZXNzYWdlKGZhbHNlKTtcclxuICAgICAgc2V0RXJyb3JNZXNzYWdlcyhmYWxzZSk7XHJcblxyXG4gICAgICBjb25zdCB7IGZvcm1JRCwgYmFja2VuZFVybCwganVtcFRvQ29uZmlybWF0aW9uLCBvblN1Ym1pdFN1Y2Nlc3MsIG9uRXJyb3IgfSA9IHByb3BzO1xyXG4gICAgICBjb25zdCBnZlN1Ym1pc3Npb25VcmwgPSBiYWNrZW5kVXJsLnN1YnN0cmluZygwLCBiYWNrZW5kVXJsLmluZGV4T2YoJy93cC1qc29uJykpO1xyXG5cclxuICAgICAgZmV0Y2goYCR7Z2ZTdWJtaXNzaW9uVXJsfS93cC1qc29uL2dmL3YyL2Zvcm1zLyR7Zm9ybUlEfS9zdWJtaXNzaW9uc2AsIHtcclxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICBib2R5OiBmb3JtRGF0YSxcclxuICAgICAgfSlcclxuICAgICAgICAudGhlbihyZXNwID0+IHJlc3AuanNvbigpKVxyXG4gICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcclxuICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5pc192YWxpZCkge1xyXG4gICAgICAgICAgICBpZiAob25TdWJtaXRTdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgcmVzID0gb25TdWJtaXRTdWNjZXNzKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgICBpZiAoIXJlcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBjb25maXJtYXRpb25NZXNzYWdlID0gcmVzcG9uc2UuY29uZmlybWF0aW9uX21lc3NhZ2U7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgdHlwZSwgbGluayB9ID0gY29uZmlybWF0aW9uTWVzc2FnZSB8fCBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKHR5cGUgJiYgbGluayAmJiB0eXBlID09PSAncmVkaXJlY3QnKSB7XHJcbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVwbGFjZShsaW5rKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2V0U3VibWl0dGluZyhmYWxzZSk7XHJcbiAgICAgICAgICAgIHNldFN1Ym1pdFN1Y2Nlc3ModHJ1ZSk7XHJcbiAgICAgICAgICAgIHNldENvbmZpcm1hdGlvbk1lc3NhZ2UoY29uZmlybWF0aW9uTWVzc2FnZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoanVtcFRvQ29uZmlybWF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgc2Nyb2xsVG9Db25maXJtYXRpb24ocHJvcHMsIHdyYXBwZXJSZWYsIGp1bXBUb0NvbmZpcm1hdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICByZXNwb25zZSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2VzID1cclxuICAgICAgICAgICAgZXJyb3IgJiYgZXJyb3IucmVzcG9uc2UgJiYgZXJyb3IucmVzcG9uc2UudmFsaWRhdGlvbl9tZXNzYWdlc1xyXG4gICAgICAgICAgICAgID8gZXJyb3IucmVzcG9uc2UudmFsaWRhdGlvbl9tZXNzYWdlc1xyXG4gICAgICAgICAgICAgIDogJ1NvbWV0aGluZyB3ZW50IHdyb25nJztcclxuXHJcbiAgICAgICAgICBpZiAob25FcnJvcikge1xyXG4gICAgICAgICAgICBvbkVycm9yKGVycm9yTWVzc2FnZXMpO1xyXG4gICAgICAgICAgICBzZXRTdWJtaXR0aW5nKGZhbHNlKTtcclxuICAgICAgICAgICAgc2V0U3VibWl0RmFpbGVkKHRydWUpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2V0U3VibWl0dGluZyhmYWxzZSk7XHJcbiAgICAgICAgICAgIHNldFN1Ym1pdEZhaWxlZCh0cnVlKTtcclxuICAgICAgICAgICAgc2V0RXJyb3JNZXNzYWdlcyhlcnJvck1lc3NhZ2VzKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBpZiAoanVtcFRvQ29uZmlybWF0aW9uKSB7XHJcbiAgICAgICAgICAgIHNjcm9sbFRvQ29uZmlybWF0aW9uKHByb3BzLCB3cmFwcGVyUmVmKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICByZXR1cm4gKFxyXG4gICAgPEdGV3JhcHBlciByZWY9e3dyYXBwZXJSZWZ9IGNsYXNzTmFtZT1cImZvcm0td3JhcHBlclwiIGlkPXtgZ3Jhdml0eV9mb3JtXyR7Zm9ybUlEfWB9PlxyXG4gICAgICB7Zm9ybURhdGEudGl0bGUgPyBudWxsIDogTG9hZGluZyAmJiA8TG9hZGluZyBpc0xvYWRpbmcgLz59XHJcblxyXG4gICAgICB7c3VibWl0RmFpbGVkICYmICFzdWJtaXRTdWNjZXNzICYmICFvbkVycm9yICYmIChcclxuICAgICAgICA8Rm9ybUVycm9yXHJcbiAgICAgICAgICBTRm9ybUVycm9yPXtTRm9ybUVycm9yIHx8IGZhbHNlfVxyXG4gICAgICAgICAgZXJyb3JNZXNzYWdlPXtlcnJvck1lc3NhZ2UgfHwgJ1RoZXJlIHdhcyBhIHByb2JsZW0gd2l0aCB5b3VyIHN1Ym1pc3Npb24nfVxyXG4gICAgICAgIC8+XHJcbiAgICAgICl9XHJcblxyXG4gICAgICB7c3VibWl0U3VjY2VzcyAmJiBjb25maXJtYXRpb25NZXNzYWdlICYmIChcclxuICAgICAgICA8Rm9ybUNvbmZpcm1hdGlvblxyXG4gICAgICAgICAgY29uZmlybWF0aW9uPXtjb25maXJtYXRpb25NZXNzYWdlfVxyXG4gICAgICAgICAgU0Zvcm1Db25maXJtYXRpb249e1NGb3JtQ29uZmlybWF0aW9ufVxyXG4gICAgICAgIC8+XHJcbiAgICAgICl9XHJcblxyXG4gICAgICB7IXN1Ym1pdFN1Y2Nlc3MgJiYgZm9ybURhdGEuZmllbGRzID8gKFxyXG4gICAgICAgIDxmb3JtXHJcbiAgICAgICAgICBvblN1Ym1pdD17ZXZlbnQgPT4gb25TdWJtaXQoZXZlbnQpfVxyXG4gICAgICAgICAgY2xhc3NOYW1lPXtjc3NDbGFzc31cclxuICAgICAgICAgIGVuY1R5cGU9e2lzTXVsdGlwYXJ0ID8gJ211bHRpcGFydC9mb3JtLWRhdGEnIDogdW5kZWZpbmVkfVxyXG4gICAgICAgICAgbm9WYWxpZGF0ZVxyXG4gICAgICAgID5cclxuICAgICAgICAgIHsoZm9ybURhdGEudGl0bGUgfHwgZm9ybURhdGEuZGVzY3JpcHRpb24pICYmIChcclxuICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICB7Zm9ybURhdGEudGl0bGUgJiYgdGl0bGUgPyA8aDMgY2xhc3NOYW1lPVwiZm9ybS10aXRsZVwiPntmb3JtRGF0YS50aXRsZX08L2gzPiA6IG51bGx9XHJcbiAgICAgICAgICAgICAge2Zvcm1EYXRhLmRlc2NyaXB0aW9uID8gKFxyXG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiZm9ybS1kZXNjcmlwdGlvblwiPntmb3JtRGF0YS5kZXNjcmlwdGlvbn08L3A+XHJcbiAgICAgICAgICAgICAgKSA6IG51bGx9XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgKX1cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZm9ybS13cmFwcGVyXCI+XHJcbiAgICAgICAgICAgIHtmb3JtRGF0YT8ucGFnaW5hdGlvbj8ucGFnZXMgJiYgKFxyXG4gICAgICAgICAgICAgIDxQcm9ncmVzc0JhclxyXG4gICAgICAgICAgICAgICAgcGFnaW5hdGlvbj17Zm9ybURhdGEucGFnaW5hdGlvbn1cclxuICAgICAgICAgICAgICAgIGFjdGl2ZVBhZ2U9e2FjdGl2ZVBhZ2V9XHJcbiAgICAgICAgICAgICAgICBmaXJzdFBhZ2VDc3NDbGFzcz17Zm9ybURhdGEuZmlyc3RQYWdlQ3NzQ2xhc3N9XHJcbiAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgPFJlbmRlckZpZWxkc1xyXG4gICAgICAgICAgICAgIHN0eWxlZENvbXBvbmVudHM9e3N0eWxlZENvbXBvbmVudHN9XHJcbiAgICAgICAgICAgICAgY3VzdG9tQ29tcG9uZW50cz17Y3VzdG9tQ29tcG9uZW50c31cclxuICAgICAgICAgICAgICBmaWVsZHM9e2Zvcm1EYXRhLmZpZWxkc31cclxuICAgICAgICAgICAgICBmb3JtVmFsdWVzPXtmb3JtVmFsdWVzfVxyXG4gICAgICAgICAgICAgIHN1Ym1pdEZhaWxlZD17c3VibWl0RmFpbGVkfVxyXG4gICAgICAgICAgICAgIHN1Ym1pdFN1Y2Nlc3M9e3N1Ym1pdFN1Y2Nlc3N9XHJcbiAgICAgICAgICAgICAgdXBkYXRlRm9ybT17KGV2ZW50LCBmaWVsZCwgaW5wdXRJRCkgPT5cclxuICAgICAgICAgICAgICAgIHVwZGF0ZUZvcm1IYW5kbGVyKFxyXG4gICAgICAgICAgICAgICAgICBmaWVsZCxcclxuICAgICAgICAgICAgICAgICAgZXZlbnQsXHJcbiAgICAgICAgICAgICAgICAgIGlucHV0SUQsXHJcbiAgICAgICAgICAgICAgICAgIGZvcm1WYWx1ZXMsXHJcbiAgICAgICAgICAgICAgICAgIHNldEZvcm1WYWx1ZXMsXHJcbiAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbmFsSWRzLFxyXG4gICAgICAgICAgICAgICAgICBjb25kaXRpb25GaWVsZHNcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgdG91Y2hlZD17dG91Y2hlZH1cclxuICAgICAgICAgICAgICBzZXRUb3VjaGVkPXtpZCA9PiBzZXRUb3VjaGVkSGFuZGxlcihpZCwgdG91Y2hlZCwgc2V0VG91Y2hlZCl9XHJcbiAgICAgICAgICAgICAgc2V0RXJyb3JNZXNzYWdlcz17c2V0RXJyb3JNZXNzYWdlc31cclxuICAgICAgICAgICAgICBwYWdpbmF0aW9uPXtmb3JtRGF0YS5wYWdpbmF0aW9ufVxyXG4gICAgICAgICAgICAgIGFjdGl2ZVBhZ2U9e2FjdGl2ZVBhZ2V9XHJcbiAgICAgICAgICAgICAgcHJldlN0ZXA9e2UgPT4gaGFuZGxlUHJldlN0ZXAoZSl9XHJcbiAgICAgICAgICAgICAgbmV4dFN0ZXA9e2UgPT5cclxuICAgICAgICAgICAgICAgIG5leHRTdGVwKFxyXG4gICAgICAgICAgICAgICAgICBlLFxyXG4gICAgICAgICAgICAgICAgICBwcm9wcyxcclxuICAgICAgICAgICAgICAgICAgcGFnZXMsXHJcbiAgICAgICAgICAgICAgICAgIGZvcm1WYWx1ZXMsXHJcbiAgICAgICAgICAgICAgICAgIGFjdGl2ZVBhZ2UsXHJcbiAgICAgICAgICAgICAgICAgIHNldEFjdGl2ZVBhZ2UsXHJcbiAgICAgICAgICAgICAgICAgIHNldFBhZ2VDbGlja2VkLFxyXG4gICAgICAgICAgICAgICAgICBzZXRUb3VjaGVkLFxyXG4gICAgICAgICAgICAgICAgICBzZXRTaG93UGFnZVZhbGlkYXRpb25Nc2dcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgY2hlY2tDb25kaXRpb25hbExvZ2ljPXsoY29uZGl0aW9uLCBmaWVsZHMpID0+XHJcbiAgICAgICAgICAgICAgICBjaGVja0NvbmRpdGlvbmFsTG9naWMoY29uZGl0aW9uLCAoZmllbGRzID0gZmFsc2UpKVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBzYXZlU3RhdGVUb0h0bWxGaWVsZD17c2F2ZVN0YXRlVG9IdG1sRmllbGR9XHJcbiAgICAgICAgICAgICAgZW5hYmxlSG9uZXlwb3Q9e2Zvcm1EYXRhLmVuYWJsZUhvbmV5cG90fVxyXG4gICAgICAgICAgICAgIGVycm9ycz17ZXJyb3JNZXNzYWdlc31cclxuICAgICAgICAgICAgICB1bnNldEVycm9yPXtpZCA9PiB1bnNldEVycm9yKGlkLCBlcnJvck1lc3NhZ2VzKX1cclxuICAgICAgICAgICAgICBkcm9wem9uZVRleHQ9e2Ryb3B6b25lVGV4dH1cclxuICAgICAgICAgICAgICBwYWdlQ2xpY2tlZD17cGFnZUNsaWNrZWR9XHJcbiAgICAgICAgICAgICAgbGFuZ3VhZ2U9e2xhbmd1YWdlfVxyXG4gICAgICAgICAgICAgIGFwaUtleXM9e2FwaUtleXN9XHJcbiAgICAgICAgICAgICAgey4uLnByb3BzfVxyXG4gICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICB7KCFmb3JtRGF0YS5wYWdpbmF0aW9uIHx8XHJcbiAgICAgICAgICAgICAgKGZvcm1EYXRhLnBhZ2luYXRpb24gJiYgZm9ybURhdGEucGFnaW5hdGlvbi5wYWdlcy5sZW5ndGggPT09IGFjdGl2ZVBhZ2UpKSAmJiAoXHJcbiAgICAgICAgICAgICAgPFN1Ym1pdFxyXG4gICAgICAgICAgICAgICAgQnV0dG9uPXtCdXR0b259XHJcbiAgICAgICAgICAgICAgICBMb2FkaW5nPXtMb2FkaW5nfVxyXG4gICAgICAgICAgICAgICAgZm9ybURhdGE9e2Zvcm1EYXRhfVxyXG4gICAgICAgICAgICAgICAgc3VibWl0SWNvbj17c3VibWl0SWNvbn1cclxuICAgICAgICAgICAgICAgIHN1Ym1pdHRpbmc9e3N1Ym1pdHRpbmd9XHJcbiAgICAgICAgICAgICAgICBwcmV2U3RlcD17ZSA9PiBoYW5kbGVQcmV2U3RlcChlKX1cclxuICAgICAgICAgICAgICAgIGxvYWRpbmdTcGlubmVyPXtsb2FkaW5nU3Bpbm5lcn1cclxuICAgICAgICAgICAgICAgIGhpZGVTdWJtaXRCdXR0b249e2hpZGVTdWJtaXRCdXR0b259XHJcbiAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgKX1cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZm9ybT5cclxuICAgICAgKSA6IChcclxuICAgICAgICAnJ1xyXG4gICAgICApfVxyXG4gICAgPC9HRldyYXBwZXI+XHJcbiAgKTtcclxufTtcclxuXHJcbkdyYXZpdHlGb3JtLmRlZmF1bHRQcm9wcyA9IHtcclxuICB0aXRsZTogdHJ1ZSxcclxuICBzdWJtaXRJY29uOiBmYWxzZSxcclxuICBzYXZlU3RhdGVUb0h0bWxGaWVsZDogZmFsc2UsXHJcbiAganVtcFRvQ29uZmlybWF0aW9uOiB0cnVlLFxyXG59O1xyXG5cclxuZXhwb3J0IHsgdmFsaWRhdGVGaWVsZCwgRm9ybUNvbmZpcm1hdGlvbiwgRm9ybUVycm9yLCBSZW5kZXJGaWVsZHMsIFN1Ym1pdCB9O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgR3Jhdml0eUZvcm07XHJcblxyXG4iXX0=